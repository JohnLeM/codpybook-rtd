

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5.3.3 Kernel Conditional Density &mdash; CodPy Book 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.3.4 Kernel Conditional Expectation" href="ch5_34.html" />
    <link rel="prev" title="5.2 Optimal Transport: LSAP (Linear Sum Assignment Problem)" href="ch5_2.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            CodPy Book
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Chapter 2:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_ch2/index.html">Chapter 2: Basic notions on reproducing kernels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch2/ch2_2.html">2.2 Reproducing kernels and transformation maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch2/ch2_ex1D.html">2.3 1D Periodic Function Extrapolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch2/ch2_5.html">2.3.2 Applying maps to kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch2/ch2_ex2D.html">2.4 2D Periodic Function Extrapolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch2/ch2_discrepancy_functional.html">2.6.2 A study of the discrepancy functional</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Chapter 3:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_ch3/index.html">Chapter 3: Discrete operators based on reproducing kernels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch3/ch3_3_2.html">3.3.2 Partition of unity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch3/ch3_4_1.html">3.4.1 Gradient Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch3/ch3_4_2.html">3.4.2 Divergence Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch3/ch3_4_3.html">3.4.3  Inverse Laplace operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch3/ch3_4_4.html">3.4.4 Integral operator - inverse gradient operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch3/ch3_4_5.html">3.4.5  Integral operator - inverse divergence operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch3/ch3_4_6.html">3.4.6 Leray-orthogonal operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch3/ch3_4_7.html">3.4.7 Leray operator and Helmholtz-Hodge decomposition</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Chapter 4:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_ch4/index.html">Chapter 4: Clustering strategies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch4/ch4_2.html">4.2 Clustering</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Chapter 5:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Chapter 5: Optimal transport and statistical kernel methods</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ch5_2.html">5.2 Optimal Transport: LSAP (Linear Sum Assignment Problem)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.3.3 Kernel Conditional Density</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch5_34.html">5.3.4 Kernel Conditional Expectation</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch5_6_a.html">5.6.a Application of OT in Disitribution Sampling : 1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch5_6_b.html">5.6.b Application of OT in Disitribution Sampling : 2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch5_6_c.html">5.6.c Application of OT in Disitribution Sampling : High-Dimensional case</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch5_6_d.html">5.6.d Exploration Data Analysis of the Latent Space: Spherical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch5_7.html">5.7. Conditional Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="ch5_8.html">5.8. Conditional Sampling</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Chapter 6:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_ch6/index.html">Chapter 6: Applications to machine learning : supervised, unsupervised and generative methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch6/ch6_housing.html">6.1 Supervised learning: reproducibility illustration with housing prices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch6/ch6_mnist.html">6.2 Supervised learning: benchmarks of methods with MNIST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch6/ch6_Clustering.html">6.3 Unsupervised learning: Clustering - MNIST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch6/ch6_ClustMNIST.html">6.3 Unsupervised learning: Clustering - MNIST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch6/ch6_CreditCardFraud.html">6.4 Unsupervised learning: Clustering - Fraud detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch6/ch6_9_CelebA_reconstruction.html">6.4.1 Generating complex distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch6/ch6_9_CelebA.html">6.4.1 Generating complex distributions from celebA dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch6/ch6_9_transfert.html">6.4.5 Conditioning on discrete distributions of celebA dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch6/ch6_stockClustering.html">6.5 Unsupervised learning: Clustering - Stock Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch6/ch6_iris.html">6.7. Conditional Sampling</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Chapter 7:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_ch7/index.html">Chapter 7: Application to partial differential equations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch7/ch7_invLaplace.html">7.01 Inverse Laplace Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch7/ch7_denoising.html">7.02 Denoising</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch7/ch7_heat_eq.html">7.03 Heat Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch7/ch7_heatLagrange.html">7.04 Lagrange Heat Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch7/ch7_convexHull.html">7.05 Convex Hull Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch7/ch7_AAD.html">7.06 Automatic Differentiation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Chapter 8:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kqlearning.html">KQLearning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_ch8/index.html">Chapter 8: Reinforcement learning.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch8/ch8_example.html">8.1 Using KAgents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch8/ch8_cartpole.html">8.2 Experiments - Cartpole</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Chapter 9:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_ch9/index.html">Chapter 9: Mathematical Finance.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_get_market_data.html">9.01 Free time series modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_random_walk_log_normal.html">9.02 Random walks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_arma.html">9.03 ARMA(p,1) model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_garch.html">9.04 GARCH(1,1) model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_lagrange.html">9.05 Lagrange interpolation model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_additive.html">9.06 Additive noise map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_conditionning.html">9.07 Conditionning model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_stoch_vol.html">9.08 Stochastic volatility model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_HestonCompare.html">9.10 Heston Process - Path comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_isocontours.html">9.11 Heston Process - Intraday interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_priceExtrapolation.html">9.12 Price extrapolation using KRR and Taylor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_greeks.html">9.13 Greeks output after correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_rst.html">9.13 Reverse Stress Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_ch9/ch9_HestonRepro.html">9.9 Heston Process - Reproducibility</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utils/ch9/ch9_utils.html">Chapter 9 utility functions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CodPy Book</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Chapter 5: Optimal transport and statistical kernel methods</a></li>
      <li class="breadcrumb-item active">5.3.3 Kernel Conditional Density</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_ch5/ch5_33.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-ch5-ch5-33-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="kernel-conditional-density">
<span id="sphx-glr-auto-ch5-ch5-33-py"></span><h1>5.3.3 Kernel Conditional Density<a class="headerlink" href="#kernel-conditional-density" title="Link to this heading"></a></h1>
<p>In this experiment, we reproduce the results from the chapter 5.3.3 of the book.
Spefically, we will benchmark the performance of different conditional density estimators.
We will use generated data and compare Nadaraya-Watson with the Projection-based estimator from CodPy.</p>
<section id="required-imports">
<h2>Required imports<a class="headerlink" href="#required-imports" title="Link to this heading"></a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="kn">import</span> <span class="nn">codpy.core</span>
<span class="kn">from</span> <span class="nn">codpy.conditioning</span> <span class="kn">import</span> <span class="n">ConditionerKernel</span><span class="p">,</span> <span class="n">NadarayaWatsonKernel</span>
<span class="kn">from</span> <span class="nn">codpy.core</span> <span class="kn">import</span> <span class="n">kernel_setter</span>
<span class="kn">from</span> <span class="nn">codpy.utils</span> <span class="kn">import</span> <span class="n">cartesian_outer_product</span><span class="p">,</span> <span class="n">get_matrix</span>

<span class="n">codpy</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">KerInterface</span><span class="o">.</span><span class="n">set_verbose</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="generating-the-data">
<h2>Generating the data<a class="headerlink" href="#generating-the-data" title="Link to this heading"></a></h2>
<p>The data is generated according to the chapter 5.3.3 of the book. - Illustrative example.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_function_hard</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
    <span class="c1"># return np.sin(np.pi * x)</span>


<span class="k">def</span> <span class="nf">variance_function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">mean_function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">variance_function_hard</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.3</span> <span class="o">-</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">mean_function</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">generate_conditional_hetero_skedastic_density_data</span><span class="p">(</span>
    <span class="n">N_train</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mean_f</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variance_f</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate synthetic data with nonlinear and heteroscedastic structure.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - N_train: Number of training samples (X, Y)</span>
<span class="sd">    - seed: Random seed for reproducibility</span>
<span class="sd">    - mean_f: Callable for mean function, e.g., mean_function(x)</span>
<span class="sd">    - variance_f: Callable for variance function, e.g., variance_function(x)</span>

<span class="sd">    Returns:</span>
<span class="sd">    - x: Training input samples (1D array)</span>
<span class="sd">    - y: Training output samples (1D array)</span>
<span class="sd">    - z: Test input sample (scalar)</span>
<span class="sd">    - y_pdf: Grid of y values for PDF estimation</span>
<span class="sd">    - (fz_mean, fz_std): True conditional mean and std at z</span>
<span class="sd">    - density: True conditional density at z over y_pdf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mean_f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mean_f</span> <span class="o">=</span> <span class="n">mean_function</span>
    <span class="k">if</span> <span class="n">variance_f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">variance_f</span> <span class="o">=</span> <span class="n">variance_function</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">N_train</span><span class="p">)</span>
    <span class="n">mean_y</span> <span class="o">=</span> <span class="n">mean_f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">std_y</span> <span class="o">=</span> <span class="n">variance_f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mean_y</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">std_y</span><span class="p">)</span>

    <span class="n">z</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">fz_mean</span> <span class="o">=</span> <span class="n">mean_f</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">fz_std</span> <span class="o">=</span> <span class="n">variance_f</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="n">y_pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">N_train</span><span class="p">)</span>
    <span class="n">density</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">fz_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">fz_std</span><span class="p">)</span>
    <span class="n">density</span> <span class="o">/=</span> <span class="n">density</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">y_pdf</span><span class="p">,</span> <span class="p">(</span><span class="n">fz_mean</span><span class="p">,</span> <span class="n">fz_std</span><span class="p">),</span> <span class="n">density</span>


<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">y_pdf</span><span class="p">,</span> <span class="p">(</span><span class="n">fz_mean</span><span class="p">,</span> <span class="n">fz_std</span><span class="p">),</span> <span class="n">density</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">generate_conditional_hetero_skedastic_density_data</span><span class="p">(</span>
        <span class="n">N_train</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mean_f</span><span class="o">=</span><span class="n">mean_function</span><span class="p">,</span>
        <span class="n">variance_f</span><span class="o">=</span><span class="n">variance_function</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="plotting-the-data">
<h2>Plotting the data<a class="headerlink" href="#plotting-the-data" title="Link to this heading"></a></h2>
<p>We plot the data with the test points z and true conditional density p(y | z).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_data_with_test_point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">y_pdf</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Training Data (X, Y)&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Mark test point z</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">cartesian_outer_product</span><span class="p">(</span><span class="n">get_matrix</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">get_matrix</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">out</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">out</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test set&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Training Data with Test Point&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plot_data_with_test_point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">y_pdf</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_ch5_33_001.png" srcset="../_images/sphx_glr_ch5_33_001.png" alt="Training Data with Test Point" class = "sphx-glr-single-img"/></section>
<section id="estimators">
<h2>Estimators<a class="headerlink" href="#estimators" title="Link to this heading"></a></h2>
<p>We now use Nadaraya-Watson, CodPy’s Conditioner, and KDE to estimate the conditional density.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_pdf</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">y_pdf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">)</span>


<span class="c1"># For Kde, we use NadarayaWatsonKernel with the map set to bandwith.</span>
<span class="n">nw</span> <span class="o">=</span> <span class="n">NadarayaWatsonKernel</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">set_kernel</span><span class="o">=</span><span class="n">kernel_setter</span><span class="p">(</span><span class="n">kernel_string</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span><span class="n">kernel_args</span><span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bandwidth&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">}),</span>
<span class="p">)</span>
<span class="n">kde_result</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">joint_density</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">kde_result</span> <span class="o">=</span> <span class="n">kde_result</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">kde_result</span> <span class="o">/=</span> <span class="n">kde_result</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Without any specific kernel and maps, the default NadarayaWatson is used.</span>

<span class="n">X_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">kde_bandwidth</span> <span class="o">=</span> <span class="mi">13</span>
<span class="c1"># kde_model = NadarayaWatsonKernel(</span>
<span class="c1">#     x=x, y=y, set_kernel=kernel_setter(&quot;gaussian&quot;, &quot;bandwidth&quot;, bandwidth=kde_bandwidth)</span>
<span class="c1"># )</span>
<span class="c1"># mean_codpy = kde_model.expectation(</span>
<span class="c1">#     X_eval,</span>
<span class="c1">#     reg=0.1,</span>
<span class="c1"># )</span>
<span class="n">codpy_model</span> <span class="o">=</span> <span class="n">ConditionerKernel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">mean_codpy</span> <span class="o">=</span> <span class="n">codpy_model</span><span class="o">.</span><span class="n">expectation</span><span class="p">(</span><span class="n">X_eval</span><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>


<span class="c1"># y_demeaned = y.reshape(-1, 1) - mean_codpy.reshape(-1, 1)</span>

<span class="c1"># nw = NadarayaWatsonKernel(x=x, y=y_demeaned)</span>
<span class="n">nw</span> <span class="o">=</span> <span class="n">NadarayaWatsonKernel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">nw_result</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">joint_density</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">nw_result</span> <span class="o">=</span> <span class="n">nw_result</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">nw_result</span> <span class="o">/=</span> <span class="n">nw_result</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="n">codpy</span> <span class="o">=</span> <span class="n">ConditionerKernel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">codpy_result</span> <span class="o">=</span> <span class="n">codpy</span><span class="o">.</span><span class="n">get_transition</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>
<span class="n">codpy_result</span> <span class="o">/=</span> <span class="n">codpy_result</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="plotting-the-results">
<h2>Plotting the results<a class="headerlink" href="#plotting-the-results" title="Link to this heading"></a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_conditional_estimates</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">true_density</span><span class="p">,</span> <span class="n">nw</span><span class="p">,</span> <span class="n">kde</span><span class="p">,</span> <span class="n">codpy</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">true_density</span><span class="p">,</span> <span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;True $p(y|z=</span><span class="si">{</span><span class="n">z</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">nw</span><span class="p">,</span> <span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Nadaraya-Watson&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">kde</span><span class="p">,</span> <span class="s2">&quot;b-.&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Nadaraya-Watson (with bandwidth)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">codpy</span><span class="p">,</span> <span class="s2">&quot;g:&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CodPy ConditionerKernel&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated Conditional Densities at z = </span><span class="si">{</span><span class="n">z</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">X_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">kde_bandwidth</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z_scalar</span><span class="p">,</span> <span class="n">y_pdf</span><span class="p">,</span> <span class="p">(</span><span class="n">fz_mean</span><span class="p">,</span> <span class="n">fz_std</span><span class="p">),</span> <span class="n">true_density</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">generate_conditional_hetero_skedastic_density_data</span><span class="p">(</span>
        <span class="n">N_train</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">mean_f</span><span class="o">=</span><span class="n">mean_function</span><span class="p">,</span>
        <span class="n">variance_f</span><span class="o">=</span><span class="n">variance_function</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">y_pdf</span> <span class="o">=</span> <span class="n">y_pdf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">z_scalar</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># KDE with fixed bandwidth</span>
<span class="n">kde_model</span> <span class="o">=</span> <span class="n">NadarayaWatsonKernel</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">set_kernel</span><span class="o">=</span><span class="n">kernel_setter</span><span class="p">(</span><span class="n">kernel_string</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span><span class="n">kernel_args</span><span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bandwidth&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">})</span>
<span class="p">)</span>
<span class="n">kde_result</span> <span class="o">=</span> <span class="n">kde_model</span><span class="o">.</span><span class="n">joint_density</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">kde_result</span> <span class="o">/=</span> <span class="n">kde_result</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Nadaraya-Watson with de-meaned residuals</span>
<span class="n">nw_model</span> <span class="o">=</span> <span class="n">NadarayaWatsonKernel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">nw_result</span> <span class="o">=</span> <span class="n">nw_model</span><span class="o">.</span><span class="n">joint_density</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">nw_result</span> <span class="o">/=</span> <span class="n">nw_result</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># CodPy density estimate</span>
<span class="n">codpy</span> <span class="o">=</span> <span class="n">ConditionerKernel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">codpy_result</span> <span class="o">=</span> <span class="n">codpy</span><span class="o">.</span><span class="n">get_transition</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>
<span class="n">codpy_result</span> <span class="o">/=</span> <span class="n">codpy_result</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">true_density</span><span class="p">,</span> <span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">nw_result</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;r-.&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NW&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">kde_result</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;b-.&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NW with wb&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pdf</span><span class="p">,</span> <span class="n">codpy_result</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;g:&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CodPy&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Conditional Density Estimate ($\mu(x) = \sin(\pi x)$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">pass</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_ch5_33_002.png" srcset="../_images/sphx_glr_ch5_33_002.png" alt="Conditional Density Estimate ($\mu(x) = \sin(\pi x)$)" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 0.470 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-ch5-ch5-33-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9e5ac3bf2150e6f108d2db5b9a8e331d/ch5_33.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">ch5_33.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/c6f03db0cbdfba8d91adfa6be87ec3f3/ch5_33.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">ch5_33.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/226c1fe899fb35a38a7a44eef1c24bca/ch5_33.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">ch5_33.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ch5_2.html" class="btn btn-neutral float-left" title="5.2 Optimal Transport: LSAP (Linear Sum Assignment Problem)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ch5_34.html" class="btn btn-neutral float-right" title="5.3.4 Kernel Conditional Expectation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Philippe G. LeFloch , Jean-Marc Mercier, and Shohruh Miryusupov.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>